<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description"
        content="What Truly Matters in Trajectory Prediction for Autonomous Driving?">
  <meta name="keywords" content="motion prediction, motion planning, ade, fde">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>What Truly Matters in Trajectory Prediction for Autonomous Driving?</title>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">
  <link rel="icon" href="./static/images/favicon.ico">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <!-- <script src="./static/js/index.js"></script> -->
</head>
<body>

<nav class="navbar" role="navigation" aria-label="main navigation">
  <div class="navbar-brand">
    <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
    </a>
  </div>
  <div class="navbar-menu">
    <div class="navbar-start" style="flex-grow: 1; justify-content: center;">
      <a class="navbar-item" href="https://adacomp.comp.nus.edu.sg">
      <span class="icon">
          <i class="fas fa-home"></i>
      </span>
      </a>
      </div>
    </div>

  </div>
</nav>

<section class="hero">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <h1 class="title is-1 publication-title">What Truly Matters in Trajectory Prediction for Autonomous Driving?</h1>
          <div class="is-size-5 publication-authors">
            <span class="author-block">
              <a href="https://tpvt99.github.io">Phong Tran*</a><sup>2</sup>,
            </span>
            <span class="author-block">
              <a href="">Haoran Wu*</a><sup>1,2</sup>,
            </span>
            <span class="author-block">
              <a href="https://majiker.github.io">Cunjun Yu*</a><sup>2</sup>,
            </span>
            <span class="author-block">
              <a href="http://cindycia.github.io">Panpan Cai</a><sup>3</sup>,
            </span>
            <span class="author-block">
              <a href="">Sifa Zheng</a><sup>1</sup>,
            </span>
            <span class="author-block">
              <a href="https://www.comp.nus.edu.sg/~dyhsu/">David Hsu</a><sup>2</sup>,
            </span>
          </div>

          <div class="is-size-5 publication-authors">
            <span class="author-block"><sup>1</sup>Tshinghua University,</span>
            <span class="author-block"><sup>2</sup>National University of Singapore</span>
            <span class="author-block"><sup>3</sup>Shanghai Jiao Tong University</span>
          </div>

          <div class="column has-text-centered">
            <div class="publication-links">
              <!-- PDF Link. -->
              <span class="link-block">
                <a href="https://arxiv.org/pdf/2306.15136"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                  </span>
                  <span>Paper</span>
                </a>
              </span>
              <span class="link-block">
                <a href="https://arxiv.org/abs/2306.15136"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="ai ai-arxiv"></i>
                  </span>
                  <span>arXiv</span>
                </a>
              </span>
              <span class="link-block">
                <a href="https://github.com/AdaCompNUS/WhatMatters"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-github"></i>
                  </span>
                  <span>Code</span>
                </a>
              </span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="hero teaser">
  <div class="container is-max-desktop">
    <div class="hero-body">
      <img id="teaser" height="100%" src="./static/images/teaser.png">
      <h2 class="subtitle has-text-centered">
        Prediction performance vs driving performance. 
        Contrary to popular belief (<b>Black Curve</b>), our study surprisingly indicates 
        no strong correlation between current prediction evaluation metrics and 
        real driving performance (<span style="color:red">Red Curve</span>). 
        Eight representative prediction models are selected: Constant Velocity (CV),
        Constant Acceleration (CA), K-Nearest Neighbor (KNN), Social KNN (S-KNN), HiVT, 
        LaneGCN, LSTM and Social LSTM (S-LSTM).
      </h2>
    </div>
  </div>
</section>


<section class="section">
  <div class="container is-max-desktop">
    <!-- Abstract. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <p>
            In the autonomous driving system, 
            trajectory prediction plays a vital role in ensuring safety and facilitating smooth navigation. 
            However, we observe a substantial discrepancy between the accuracy of predictors on 
            fixed datasets and their driving performance when used in downstream tasks. 
            This discrepancy arises from two overlooked factors in the current evaluation 
            protocols of trajectory prediction: 1) the dynamics gap between the dataset and real driving scenario; 
            and 2) the computational efficiency of predictors. 
            In real-world scenarios, prediction algorithms influence the behavior of autonomous vehicles,
             which, in turn, alter the behaviors of other agents on the road. 
             This interaction results in predictor-specific dynamics that directly impact prediction results. 
             As other agents' responses are predetermined on datasets, 
             a significant dynamics gap arises between evaluations conducted on 
             fixed datasets and actual driving scenarios. 
             Furthermore, focusing solely on accuracy fails to address the demand for computational efficiency, 
             which is critical for the real-time response required by the autonomous driving system. 
             Therefore, in this paper, we demonstrate that an interactive, 
             task-driven evaluation approach for trajectory prediction is 
             crucial to reflect its efficacy for autonomous driving. 
          </p>
        </div>
      </div>
    </div>
    <!--/ Abstract. -->

</section>

<section class="section">
  <div class="container is-max-desktop">

    <div class="columns is-centered">

      <div class="column">
        <div class="content">
          <h3 class="title is-3">TL;DR</h3>
          <p>We emprically prove that motion prediction does not correlate to driving performance.
            It is due to 2 factors: the dynamics gap and the computational efficiency.
          </p>
        </div>
      </div>
    </div>

    <div class="columns is-centered">
      <div class="column">
        <div class="content">
          <h3 class="title is-3">Experiment Setup</h3>
          <h4 class="title is-4">Motion Predictions</h4>
          <p>We use 10 motion predictors, encompassing both model-based and data-driven approaches. The following table shows 10 methods 
          (please refer to the paper for citation):</p>
          <img id="moped" height="100%" src="./static/images/moped.png">

          <h4 class="title is-4">Motion Planners</h4>
          <p>We use 2 planners to plan the self-driving cars. The first planner is based on Reciprocal Velocity Obstacles (RVO) which optimizes
            the output action in velocity space for collision avoidance. The second planner is DESPOT which utilizes POMDP for decision making under
            uncertainty. 
          </p>
          <img id="planner" height="100%" src="./static/images/planner.png">

          <h4 class="title is-4">Simulators and Maps</h4>
          <p>We use SUMMIT as our simulator. We diversify the maps including highways, intersections, roundabouts so we can test the robustness of 
            each planner in varied environments.
          </p>

          <h4 class="title is-4">Planning metrics</h4>
          <p>The driving performance is primarily determined by three factors:
            safety, comfort and efficiency. We standardize the direction of these metrics, with higher values indicating better performance
          </p>
          <img id="driving" height="100%" src="./static/images/driving.png">
        </div>
      </div>
    </div>

    <div class="columns is-centered">
      <div class="column">
        <div class="content">
          <h3 class="title is-3">Results</h3>
          <h4 class="title is-4">Limitation Of Current Prediction Evaluation</h4>
          <p>
            As seen from below diagram, there exists no correlation between ADE and driving performance for both RVO and DESPOT.
            Also there is an abnormal positive correlation for DESPOT which lack a realistic basis.
            This observation affirms the drawback of static evaluation using ADE or FDE.
          </p>
          <img id="nocorrelation" height="100%" src="./static/images/nocorrelation.png">

          <h4 class="title is-4">Fixed proposals: Dynamics Gap</h4>
          <p>
            We observe that the discrepancy is due to the dynamics gap: in offline evaluation, the vehicle responses are predetermined
            while in real-world, its behavior is changed according to other vehicles which are influenced by their predictor model.
            To minimize this gap, we propose the use of an interactive simulation environment to evaluate the predictor for downstream
            decision-making.
          </p>
          <img id="gap" height="100%" src="./static/images/gaps.png">

          <h4 class="title is-4">New Result: Dynamic ADE correleates Driving Performance</h4>
          <p>
            As seen from below diagram, the Dynamic ADE now correlates with driving performance: the lower of Dynamic ADE,
            the higher (better) driving performance.
          </p>
          <img id="dynADE" height="100%" src="./static/images/dynamicADE.png">
        </div>
      </div>
    </div>

    <div class="columns is-centered">
      <div class="column">
        <div class="content">
          <h3 class="title is-3">Conclusion</h3>
          We study that the current evaluation of the motion prediction (ADE/FDE) does not indicate the overall performance of the 
          driving system. We identify the dynamics gaps and inference speed of predictors are 2 primary causes of this discrepancy.
          We push for the dynamic, closed-loop planning evaluation that results in a more informed performance of the system.
        </div>
      </div>
    </div>

  </div>
</section>

<section class="section" id="BibTeX">
  <div class="container is-max-desktop content">
    <h2 class="title">BibTeX</h2>
    <pre><code>@article{TranWu2023whatmatters,
  author    = {Phong Tran, Haoran Wu Cunjun Yu, Panpan Cai, Sifa Zheng, David Hsu},
  title     = {What Truly Matters in Trajectory Prediction for Autonomous Driving?},
  journal   = {NeurIPS},
  year      = {2023},
}</code></pre>
  </div>
</section>


<footer class="footer">
  <div class="container">
    <div class="content has-text-centered">
      <a class="icon-link" href="https://github.com/whatmatters23/whatmatters23.github.io" class="external-link" disabled>
        <i class="fab fa-github"></i>
      </a>
    </div>
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">
          <p>
            This website is licensed under a <a rel="license"
                                                href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
            Commons Attribution-ShareAlike 4.0 International License</a>.
          </p>
          <p>
            This means you are free to borrow the <a
              href="https://github.com/nerfies/nerfies.github.io">source code</a> of this website,
            we just ask that you link back to this page in the footer.
            Please remember to remove the analytics code included in the header of the website which
            you do not want on your website.
          </p>
        </div>
      </div>
    </div>
  </div>
</footer>

</body>
</html>
